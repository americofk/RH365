{"version":3,"file":"loan-form.js","sourceRoot":"","sources":["../../../TS/Loans/loan-form.ts"],"names":[],"mappings":"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","sourcesContent":["// ============================================================================\n// Archivo: loan-form.ts\n// Proyecto: RH365.WebMVC\n// Ruta: TS/Loans/loan-form.ts\n// Descripción: \n//   - Formulario dinámico para Crear/Editar Préstamos\n//   - Tab General: Campos de negocio en LAYOUT DE 2 COLUMNAS\n//   - Tab Auditoría: Campos ISO 27001 en 1 columna\n//   - Renderizado separado para cada tab\n//   - Validación cliente + servidor\n//   - Integración con API REST (/api/Loans)\n//   - Labels a la izquierda de los campos\n// ============================================================================\n\n(function () {\n    const w: any = window;\n    const d: Document = document;\n    const $: any = w.jQuery || w.$;\n\n    const apiBase: string = w.RH365.urls.apiBase;\n    const pageContainer = d.querySelector(\"#loan-form-page\");\n\n    if (!pageContainer) return;\n\n    const token: string = pageContainer.getAttribute(\"data-token\") || \"\";\n    const dataareaId: string = pageContainer.getAttribute(\"data-dataarea\") || \"DAT\";\n    const userRefRecID: number = parseInt(pageContainer.getAttribute(\"data-user\") || \"0\", 10);\n    const recId: number = parseInt(pageContainer.getAttribute(\"data-recid\") || \"0\", 10);\n    const isNew: boolean = pageContainer.getAttribute(\"data-isnew\") === \"true\";\n\n    interface FieldConfig {\n        field: string;\n        label: string;\n        type: 'text' | 'number' | 'date' | 'datetime' | 'textarea' | 'select' | 'checkbox';\n        required?: boolean;\n        maxLength?: number;\n        options?: { value: string; text: string }[];\n        placeholder?: string;\n        helpText?: string;\n        readonly?: boolean;\n        column?: 'left' | 'right';\n    }\n\n    const businessFields: FieldConfig[] = [\n        // COLUMNA IZQUIERDA\n        {\n            field: 'LoanCode',\n            label: 'Código Préstamo',\n            type: 'text',\n            required: true,\n            maxLength: 50,\n            placeholder: 'LOAN-001',\n            column: 'left'\n        },\n        {\n            field: 'Name',\n            label: 'Nombre',\n            type: 'text',\n            required: true,\n            maxLength: 200,\n            column: 'left'\n        },\n        {\n            field: 'Description',\n            label: 'Descripción',\n            type: 'textarea',\n            maxLength: 500,\n            column: 'left'\n        },\n        {\n            field: 'LedgerAccount',\n            label: 'Cuenta Contable',\n            type: 'text',\n            maxLength: 50,\n            placeholder: '1.01.001',\n            column: 'left'\n        },\n\n        // COLUMNA DERECHA\n        {\n            field: 'ValidFrom',\n            label: 'Válido Desde',\n            type: 'date',\n            column: 'right'\n        },\n        {\n            field: 'ValidTo',\n            label: 'Válido Hasta',\n            type: 'date',\n            column: 'right'\n        },\n        {\n            field: 'MultiplyAmount',\n            label: 'Monto Multiplicador',\n            type: 'number',\n            column: 'right'\n        },\n        {\n            field: 'PayFrecuency',\n            label: 'Frecuencia de Pago',\n            type: 'number',\n            column: 'right'\n        },\n        {\n            field: 'IndexBase',\n            label: 'Base de Índice',\n            type: 'number',\n            column: 'right'\n        },\n        {\n            field: 'LoanStatus',\n            label: 'Estado del Préstamo',\n            type: 'select',\n            required: true,\n            options: [\n                { value: 'true', text: 'Activo' },\n                { value: 'false', text: 'Inactivo' }\n            ],\n            column: 'right'\n        }\n    ];\n\n    const auditFields: FieldConfig[] = [\n        {\n            field: 'RecID',\n            label: 'RecID (Clave Primaria)',\n            type: 'number',\n            readonly: true,\n        },\n        {\n            field: 'ID',\n            label: 'ID Sistema',\n            type: 'text',\n            readonly: true,\n        },\n        {\n            field: 'DataareaID',\n            label: 'Empresa (DataareaID)',\n            type: 'text',\n            readonly: true,\n        },\n        {\n            field: 'CreatedBy',\n            label: 'Creado Por',\n            type: 'text',\n            readonly: true,\n        },\n        {\n            field: 'CreatedOn',\n            label: 'Fecha de Creación',\n            type: 'datetime',\n            readonly: true,\n        },\n        {\n            field: 'ModifiedBy',\n            label: 'Modificado Por',\n            type: 'text',\n            readonly: true,\n        },\n        {\n            field: 'ModifiedOn',\n            label: 'Fecha de Última Modificación',\n            type: 'datetime',\n            readonly: true,\n        }\n    ];\n\n    let loanData: any = null;\n\n    const fetchJson = async (url: string, options: RequestInit = {}): Promise<any> => {\n        const headers: Record<string, string> = {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n        };\n        if (token) {\n            headers['Authorization'] = `Bearer ${token}`;\n        }\n        const response = await fetch(url, { ...options, headers });\n        if (!response.ok) {\n            throw new Error(`HTTP ${response.status} @ ${url}`);\n        }\n        return response.json();\n    };\n\n    const renderField = (config: FieldConfig, value: any, is2Column: boolean = false): string => {\n        const fieldId = config.field;\n        const fieldName = config.field;\n\n        const labelClass = is2Column\n            ? 'control-label col-md-4 col-sm-4 col-xs-12'\n            : 'control-label col-md-3 col-sm-3 col-xs-12';\n\n        const inputContainerClass = is2Column\n            ? 'col-md-8 col-sm-8 col-xs-12'\n            : 'col-md-6 col-sm-6 col-xs-12';\n\n        const requiredMark = config.required ? '<span class=\"required\">*</span>' : '';\n        const readonlyAttr = config.readonly ? 'readonly' : '';\n        const requiredAttr = config.required ? 'required' : '';\n\n        let inputHtml = '';\n        let displayValue = value ?? '';\n\n        switch (config.type) {\n            case 'textarea':\n                inputHtml = `<textarea id=\"${fieldId}\" name=\"${fieldName}\" class=\"form-control\" rows=\"3\" maxlength=\"${config.maxLength || 500}\" ${readonlyAttr} ${requiredAttr}>${displayValue}</textarea>`;\n                break;\n\n            case 'select':\n                const options = config.options || [];\n                const optionsHtml = options.map(opt =>\n                    `<option value=\"${opt.value}\" ${displayValue.toString() === opt.value ? 'selected' : ''}>${opt.text}</option>`\n                ).join('');\n                inputHtml = `<select id=\"${fieldId}\" name=\"${fieldName}\" class=\"form-control\" ${readonlyAttr ? 'disabled' : ''} ${requiredAttr}>${optionsHtml}</select>`;\n                break;\n\n            case 'checkbox':\n                const checked = displayValue === true || displayValue === 'true' ? 'checked' : '';\n                inputHtml = `<input type=\"checkbox\" id=\"${fieldId}\" name=\"${fieldName}\" class=\"flat\" ${checked} ${readonlyAttr ? 'disabled' : ''}>`;\n                break;\n\n            case 'datetime':\n                if (displayValue && typeof displayValue === 'string' && /^\\d{4}-\\d{2}-\\d{2}T/.test(displayValue)) {\n                    displayValue = new Date(displayValue).toLocaleString('es-DO', {\n                        year: 'numeric',\n                        month: '2-digit',\n                        day: '2-digit',\n                        hour: '2-digit',\n                        minute: '2-digit',\n                        second: '2-digit'\n                    });\n                }\n                inputHtml = `<input type=\"text\" id=\"${fieldId}\" name=\"${fieldName}\" class=\"form-control\" value=\"${displayValue}\" ${readonlyAttr} ${requiredAttr}>`;\n                break;\n\n            case 'date':\n                if (displayValue && typeof displayValue === 'string' && /^\\d{4}-\\d{2}-\\d{2}T/.test(displayValue)) {\n                    displayValue = displayValue.split('T')[0];\n                }\n                inputHtml = `<input type=\"date\" id=\"${fieldId}\" name=\"${fieldName}\" class=\"form-control\" value=\"${displayValue}\" ${readonlyAttr} ${requiredAttr}>`;\n                break;\n\n            case 'number':\n                inputHtml = `<input type=\"number\" step=\"any\" id=\"${fieldId}\" name=\"${fieldName}\" class=\"form-control\" value=\"${displayValue}\" ${readonlyAttr} ${requiredAttr}>`;\n                break;\n\n            default: // text\n                inputHtml = `<input type=\"text\" id=\"${fieldId}\" name=\"${fieldName}\" class=\"form-control\" maxlength=\"${config.maxLength || 255}\" value=\"${displayValue}\" placeholder=\"${config.placeholder || ''}\" ${readonlyAttr} ${requiredAttr}>`;\n                break;\n        }\n\n        const helpTextHtml = config.helpText ? `<span class=\"help-block\">${config.helpText}</span>` : '';\n\n        return `\n            <div class=\"form-group\">\n                <label class=\"${labelClass}\" for=\"${fieldId}\">\n                    ${config.label} ${requiredMark}\n                </label>\n                <div class=\"${inputContainerClass}\">\n                    ${inputHtml}\n                    ${helpTextHtml}\n                </div>\n            </div>\n        `;\n    };\n\n    const loadLoanData = async (): Promise<void> => {\n        try {\n            if (isNew) {\n                renderBusinessTab({});\n                renderAuditTab({});\n                return;\n            }\n\n            const url = `${apiBase}/Loans/${recId}`;\n            const data = await fetchJson(url);\n            loanData = data;\n\n            renderBusinessTab(data);\n            renderAuditTab(data);\n        } catch (error) {\n            (w as any).ALERTS.error('Error al cargar el préstamo', 'Error');\n        }\n    };\n\n    const renderBusinessTab = (data: any): void => {\n        const leftFields = businessFields.filter(f => f.column === 'left');\n        const rightFields = businessFields.filter(f => f.column === 'right');\n\n        const leftHtml = leftFields.map(config => {\n            const value = data[config.field];\n            return renderField(config, value, true);\n        }).join('');\n\n        const rightHtml = rightFields.map(config => {\n            const value = data[config.field];\n            return renderField(config, value, true);\n        }).join('');\n\n        d.getElementById('dynamic-fields-col-left')!.innerHTML = leftHtml;\n        d.getElementById('dynamic-fields-col-right')!.innerHTML = rightHtml;\n\n        if ($.fn.iCheck) {\n            $('.flat').iCheck({ checkboxClass: 'icheckbox_flat-green' });\n        }\n    };\n\n    const renderAuditTab = (data: any): void => {\n        const auditHtml = auditFields.map(config => {\n            const value = data[config.field];\n            return renderField(config, value, false);\n        }).join('');\n\n        d.getElementById('audit-fields-container')!.innerHTML = auditHtml;\n    };\n\n    const saveLoan = async (): Promise<void> => {\n        try {\n            const formData: any = {\n                LoanCode: ($('#LoanCode').val() as string).trim(),\n                Name: ($('#Name').val() as string).trim(),\n                Description: ($('#Description').val() as string).trim() || null,\n                ValidFrom: $('#ValidFrom').val() || null,\n                ValidTo: $('#ValidTo').val() || null,\n                MultiplyAmount: parseFloat($('#MultiplyAmount').val() as string) || 0,\n                LedgerAccount: ($('#LedgerAccount').val() as string).trim() || null,\n                PayFrecuency: parseInt($('#PayFrecuency').val() as string) || 0,\n                IndexBase: parseFloat($('#IndexBase').val() as string) || 0,\n                LoanStatus: $('#LoanStatus').val() === 'true',\n                DataareaID: dataareaId\n            };\n\n            if (!formData.LoanCode || !formData.Name) {\n                (w as any).ALERTS.warn('Complete los campos requeridos', 'Validación');\n                return;\n            }\n\n            let url = `${apiBase}/Loans`;\n            let method = 'POST';\n            let payload = formData;\n\n            if (!isNew) {\n                url = `${apiBase}/Loans/${recId}`;\n                method = 'PUT';\n                delete payload.DataareaID;\n            }\n\n            await fetchJson(url, {\n                method,\n                body: JSON.stringify(payload)\n            });\n\n            (w as any).ALERTS.ok('Préstamo guardado correctamente', 'Éxito');\n            //setTimeout(() => {\n            //    window.location.href = '/Loan/LP_Loans';\n            //}, 1500);\n        } catch (error) {\n            (w as any).ALERTS.error('Error al guardar el préstamo', 'Error');\n        }\n    };\n\n    $('#btn-save').on('click', saveLoan);\n\n    $(async function () {\n        await loadLoanData();\n    });\n})();\n"]}