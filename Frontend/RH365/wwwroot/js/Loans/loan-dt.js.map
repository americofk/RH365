{"version":3,"file":"loan-dt.js","sourceRoot":"","sources":["../../../TS/Loans/loan-dt.ts"],"names":[],"mappings":"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","sourcesContent":["// ============================================================================\r\n// Archivo: loan-dt.ts\r\n// Proyecto: RH365.WebMVC\r\n// Ruta: TS/Loans/loan-dt.ts\r\n// Descripción:\r\n//   - Lista de Préstamos con DataTables (tabla inteligente).\r\n//   - Gestor de vistas (UserGridViews) y de columnas (GridColumnsManager).\r\n//   - Corrige desaparición de tabla al cambiar de vista (re-init seguro).\r\n// Requisitos globales: RH365.urls.apiBase, ALERTS, GridViewsManager, GridColumnsManager,\r\n//   jQuery, DataTables (+ responsive), iCheck.\r\n// ============================================================================\r\n\r\ntype LoanRow = Record<string, unknown>;\r\n\r\ninterface LoanResponse {\r\n    Data: LoanRow[];\r\n    TotalCount: number;\r\n    PageNumber: number;\r\n    PageSize: number;\r\n    TotalPages: number;\r\n    HasNextPage: boolean;\r\n    HasPreviousPage: boolean;\r\n}\r\n\r\ninterface ColumnConfig {\r\n    field: string;\r\n    visible: boolean;\r\n    order: number;\r\n    width?: number;\r\n}\r\n\r\n(function () {\r\n    const w: any = window;\r\n    const d: Document = document;\r\n    const $: any = w.jQuery || w.$;\r\n\r\n    // Contexto de página\r\n    const apiBase: string = (w.RH365 && w.RH365.urls && w.RH365.urls.apiBase) ? w.RH365.urls.apiBase : \"/api\";\r\n    const page = d.querySelector(\"#loans-page\");\r\n    if (!page) return;\r\n\r\n    const token: string = page.getAttribute(\"data-token\") || \"\";\r\n    const dataareaId: string = page.getAttribute(\"data-dataarea\") || \"DAT\";\r\n    const userRefRecID: number = parseInt(page.getAttribute(\"data-user\") || \"0\", 10);\r\n\r\n    const $table: any = $(\"#loans-table\");\r\n    if (!$table.length) return;\r\n\r\n    // Estado\r\n    let loansData: LoanRow[] = [];\r\n    let allColumns: string[] = [];\r\n    let visibleColumns: string[] = [];\r\n    const defaultColumns: string[] = ['ID', 'LoanCode', 'Name', 'LedgerAccount', 'LoanStatus', 'CreatedOn', 'ValidFrom', 'ValidTo'];\r\n\r\n    let gridViewsManager: any;\r\n    let gridColumnsManager: any;\r\n\r\n    // Etiquetas\r\n    const titleize = (field: string): string => {\r\n        const map: Record<string, string> = {\r\n            'RecID': 'ID Registro',\r\n            'ID': 'ID',\r\n            'LoanCode': 'Código Préstamo',\r\n            'Name': 'Nombre',\r\n            'LedgerAccount': 'Cuenta Contable',\r\n            'LoanStatus': 'Estado',\r\n            'CreatedOn': 'Fecha Creación',\r\n            'CreatedBy': 'Creado Por',\r\n            'ModifiedOn': 'Modificado',\r\n            'ModifiedBy': 'Modificado Por',\r\n            'ValidFrom': 'Válido Desde',\r\n            'ValidTo': 'Válido Hasta',\r\n            'Observations': 'Observaciones'\r\n        };\r\n        return map[field] || field.replace(/([a-z])([A-Z])/g, \"$1 $2\").replace(/_/g, \" \").replace(/^./, c => c.toUpperCase());\r\n    };\r\n\r\n    // Formato de celdas (fechas/bools)\r\n    const formatCell = (value: unknown, field: string): string => {\r\n        if (value == null) return \"\";\r\n        if (typeof value === \"boolean\" || value === 0 || value === 1 || value === \"0\" || value === \"1\") {\r\n            const truthy = (value === true || value === 1 || value === \"1\");\r\n            if (field === \"LoanStatus\") {\r\n                return truthy ? '<span class=\"label label-success\">Activo</span>' : '<span class=\"label label-danger\">Inactivo</span>';\r\n            }\r\n            return truthy ? \"Sí\" : \"No\";\r\n        }\r\n        if (typeof value === \"string\" && /^\\d{4}-\\d{2}-\\d{2}T/.test(value)) {\r\n            const dt = new Date(value);\r\n            if (!isNaN(dt.getTime())) {\r\n                return dt.toLocaleDateString('es-DO', { day: '2-digit', month: '2-digit', year: 'numeric' });\r\n            }\r\n        }\r\n        return String(value);\r\n    };\r\n\r\n    // Fetch JSON con bearer opcional\r\n    const fetchJson = async (url: string): Promise<any> => {\r\n        const headers: Record<string, string> = { 'Accept': 'application/json', 'Content-Type': 'application/json' };\r\n        if (token) headers['Authorization'] = `Bearer ${token}`;\r\n        const r = await fetch(url, { headers });\r\n        if (!r.ok) throw new Error(`HTTP ${r.status} @ ${url}`);\r\n        return r.json();\r\n    };\r\n\r\n    // Derivar columnas desde un registro muestra\r\n    const getColumnsFromData = (sample: LoanRow): string[] => {\r\n        if (!sample || typeof sample !== 'object') return [...defaultColumns];\r\n        const excluded = new Set(['RecID', 'RowVersion', 'DataareaID']);\r\n        return Object.keys(sample).filter(k => !excluded.has(k));\r\n    };\r\n\r\n    // ==== DataTables ====\r\n\r\n    // (1) Genera cabecera y crea DT. Sin .destroy(true), sin vaciar manualmente tbody.\r\n    const initializeDataTable = (columns: string[]): void => {\r\n        // Asegurar columnas válidas vs. datos (previene \"unknown parameter\" y tabla invisible)\r\n        const safeCols = columns.filter(c => allColumns.includes(c));\r\n        const finalCols = safeCols.length ? safeCols : [...defaultColumns];\r\n\r\n        if ($.fn.DataTable.isDataTable($table)) {\r\n            const dt = $table.DataTable();\r\n            dt.clear();            // limpia datos internos\r\n            dt.destroy();          // destruye sin tocar la tabla base\r\n        }\r\n\r\n        const theadHtml = `\r\n            <tr>\r\n                <th style=\"width:40px;\"><input type=\"checkbox\" id=\"check-all\" class=\"flat\"/></th>\r\n                ${finalCols.map(col => `<th data-field=\"${col}\">${titleize(col)}</th>`).join('')}\r\n            </tr>\r\n        `;\r\n        $table.find('thead').html(theadHtml);\r\n\r\n        if ($.fn.iCheck) $('.flat').iCheck({ checkboxClass: 'icheckbox_flat-green' });\r\n\r\n        const dtConfig: any = {\r\n            processing: true,\r\n            serverSide: false,\r\n            responsive: true,\r\n            autoWidth: false,\r\n            deferRender: true,\r\n            order: [[1, 'asc']],\r\n            pageLength: 25,\r\n            lengthMenu: [[10, 25, 50, 100], [10, 25, 50, 100]],\r\n            language: {\r\n                lengthMenu: 'Mostrar _MENU_ registros',\r\n                zeroRecords: 'No se encontraron resultados',\r\n                info: 'Mostrando _START_ a _END_ de _TOTAL_ registros',\r\n                infoEmpty: 'No hay registros',\r\n                infoFiltered: '(filtrado de _MAX_ registros)',\r\n                search: 'Buscar:',\r\n                paginate: { first: 'Primera', last: 'Última', next: 'Siguiente', previous: 'Anterior' },\r\n                processing: 'Procesando...'\r\n            },\r\n            columns: [\r\n                {\r\n                    data: null,\r\n                    orderable: false,\r\n                    searchable: false,\r\n                    className: 'text-center',\r\n                    defaultContent: '',\r\n                    render: (_d: any, _t: string, row: LoanRow) =>\r\n                        `<input type=\"checkbox\" class=\"flat row-check\" data-recid=\"${(row as any).RecID ?? ''}\"/>`\r\n                },\r\n                ...finalCols.map(col => ({\r\n                    data: col,\r\n                    name: col,\r\n                    defaultContent: '',            // evita \"unknown parameter\" si falta el campo\r\n                    render: (data: unknown) => formatCell(data, col)\r\n                }))\r\n            ],\r\n            ajax: (_rq: any, callback: (r: { data: LoanRow[] }) => void) => {\r\n                loadLoans()\r\n                    .then(items => {\r\n                        loansData = items;\r\n                        callback({ data: items });\r\n                        updateSummary(items.length);\r\n                    })\r\n                    .catch(err => {\r\n                        console.error('Error cargando préstamos:', err);\r\n                        showError(err.message);\r\n                        callback({ data: [] });\r\n                    });\r\n            },\r\n            drawCallback: () => {\r\n                if ($.fn.iCheck) $table.find('.flat').iCheck({ checkboxClass: 'icheckbox_flat-green' });\r\n                const dt = $table.DataTable();\r\n                dt.columns.adjust().responsive.recalc(); // asegura layout correcto\r\n            }\r\n        };\r\n\r\n        $table.DataTable(dtConfig);\r\n    };\r\n\r\n    // Carga de datos\r\n    const loadLoans = async (): Promise<LoanRow[]> => {\r\n        const url = `${apiBase}/Loans?pageNumber=1&pageSize=100`;\r\n        const response: LoanResponse | LoanRow[] = await fetchJson(url);\r\n        if (Array.isArray(response)) return response;\r\n        if (response?.Data && Array.isArray(response.Data)) return response.Data;\r\n        return [];\r\n    };\r\n\r\n    // ==== UI ====\r\n\r\n    const updateSummary = (count: number): void => {\r\n        const el = d.getElementById('loans-summary');\r\n        if (el) el.textContent = `${count} préstamo${count !== 1 ? 's' : ''}`;\r\n    };\r\n\r\n    const showError = (message: string): void => {\r\n        $table.find('tbody').html(`\r\n            <tr>\r\n                <td colspan=\"10\" class=\"text-center text-danger\">\r\n                    <i class=\"fa fa-exclamation-triangle\"></i> ${message}\r\n                </td>\r\n            </tr>\r\n        `);\r\n    };\r\n\r\n    const updateButtonStates = (): void => {\r\n        const n = $table.find('tbody input.row-check:checked').length;\r\n        $('#btn-edit').prop('disabled', n !== 1);\r\n        $('#btn-delete').prop('disabled', n === 0);\r\n    };\r\n\r\n    const exportToCSV = (): void => {\r\n        if (!loansData.length) { (w as any).ALERTS?.warn?.('No hay datos para exportar', 'Advertencia'); return; }\r\n        const dt: any = $table.DataTable();\r\n        const rows: LoanRow[] = dt.rows({ search: 'applied' }).data().toArray();\r\n        if (!rows.length) { (w as any).ALERTS?.warn?.('No hay datos visibles para exportar', 'Advertencia'); return; }\r\n\r\n        const cols = visibleColumns.filter(c => allColumns.includes(c));\r\n        const lines: string[] = [cols.map(c => titleize(c)).join(',')];\r\n        rows.forEach(row => {\r\n            const line = cols.map(c => {\r\n                const str = String(formatCell((row as any)[c], c)).replace(/<[^>]*>/g, '').replace(/\"/g, '\"\"');\r\n                return /[\",\\n]/.test(str) ? `\"${str}\"` : str;\r\n            }).join(',');\r\n            lines.push(line);\r\n        });\r\n\r\n        const blob = new Blob(['\\ufeff' + lines.join('\\n')], { type: 'text/csv;charset=utf-8;' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = d.createElement('a');\r\n        a.href = url; a.download = `Prestamos_${new Date().toISOString().slice(0, 10)}.csv`;\r\n        d.body.appendChild(a); a.click(); d.body.removeChild(a); URL.revokeObjectURL(url);\r\n        (w as any).ALERTS?.ok?.('Datos exportados correctamente', 'Éxito');\r\n    };\r\n\r\n    const deleteLoan = async (recId: string): Promise<void> => {\r\n        const url = `${apiBase}/Loans/${recId}`;\r\n        const headers: Record<string, string> = token ? { 'Authorization': `Bearer ${token}` } : {};\r\n        const r = await fetch(url, { method: 'DELETE', headers });\r\n        if (!r.ok) throw new Error(`Error al eliminar préstamo: ${r.status}`);\r\n    };\r\n\r\n    // ==== Vistas y Columnas ====\r\n\r\n    const applyColumnChanges = (newColumns: string[]): void => {\r\n        visibleColumns = newColumns;\r\n        initializeDataTable(newColumns); // re-init limpio (sin duplicados ni desaparición)\r\n        if (gridViewsManager?.hasCurrentView?.()) $('#btn-save-view-changes').show();\r\n    };\r\n\r\n    const updateViewsDropdown = (): void => {\r\n        try {\r\n            const views = gridViewsManager.getAvailableViews();\r\n            const $container = $('#saved-views-container');\r\n            $container.empty();\r\n\r\n            if (!views?.length) {\r\n                $container.append('<li class=\"text-muted\" style=\"padding: 5px 20px;\">No hay vistas guardadas</li>');\r\n                return;\r\n            }\r\n\r\n            views.forEach((v: any) => {\r\n                const icon = v.IsDefault ? '<i class=\"fa fa-star text-warning\"></i>' : '<i class=\"fa fa-file-o\"></i>';\r\n                const $item = $(`\r\n                    <li style=\"position: relative;\">\r\n                        <a href=\"#\" data-view-id=\"${v.RecID}\" style=\"display:inline-block;width:80%;\">${icon} ${v.ViewName} ${v.IsPublic ? '<span class=\"label label-info label-sm\">Pública</span>' : ''}</a>\r\n                        ${!v.IsDefault ? `<a href=\"#\" class=\"btn-set-default\" data-view-id=\"${v.RecID}\" style=\"position:absolute;right:10px;top:5px;color:#999;\" title=\"Predeterminada\"><i class=\"fa fa-star-o\"></i></a>` : ''}\r\n                    </li>\r\n                `);\r\n                $item.find('a[data-view-id]').on('click', async (e) => { e.preventDefault(); await loadViewById(v.RecID); });\r\n                $item.find('.btn-set-default').on('click', (e) => {\r\n                    e.preventDefault(); e.stopPropagation();\r\n                    (w as any).ALERTS?.confirm?.(`¿Establecer \"${v.ViewName}\" como predeterminada?`, 'Confirmar', async (ok: boolean) => {\r\n                        if (!ok) return;\r\n                        const success = await gridViewsManager.setDefaultView(v.RecID);\r\n                        if (success) updateViewsDropdown();\r\n                    });\r\n                });\r\n                $container.append($item);\r\n            });\r\n        } catch (err) {\r\n            console.error('Error actualizando dropdown de vistas:', err);\r\n        }\r\n    };\r\n\r\n    const loadViewById = async (viewId: number): Promise<void> => {\r\n        try {\r\n            const cfg: ColumnConfig[] = await gridViewsManager.loadView(viewId);\r\n            if (!cfg?.length) return;\r\n\r\n            gridColumnsManager.applyColumnConfig(cfg);\r\n            const newCols = cfg.filter(c => c.visible).sort((a, b) => a.order - b.order).map(c => c.field);\r\n            applyColumnChanges(newCols);\r\n\r\n            const viewName = gridViewsManager.getCurrentViewName?.() || 'Vista por defecto';\r\n            $('#current-view-name').text(viewName);\r\n            $('#btn-save-view-changes').hide();\r\n        } catch (err) {\r\n            console.error('Error cargando vista:', err);\r\n            (w as any).ALERTS?.error?.('Error al cargar la vista', 'Error');\r\n        }\r\n    };\r\n\r\n    // ==== Eventos UI ====\r\n\r\n    // Check-all (delegado, funciona tras re-init)\r\n    $(document).on('ifChanged', '#check-all', function (this: HTMLInputElement) {\r\n        const checked = $(this).is(':checked');\r\n        const $checks = $table.find('tbody input.row-check');\r\n        if ($.fn.iCheck) $checks.iCheck(checked ? 'check' : 'uncheck'); else $checks.prop('checked', checked);\r\n    });\r\n\r\n    // Sincroniza botones por selección\r\n    $(document).on('ifChanged', '.row-check', updateButtonStates);\r\n\r\n    // Nuevo / Editar / Eliminar\r\n    $('#btn-new').on('click', () => { window.location.href = '/Loan/NewEdit'; });\r\n    $('#btn-edit').on('click', () => {\r\n        const $c = $table.find('tbody input.row-check:checked').first();\r\n        if ($c.length) window.location.href = `/Loan/NewEdit?recId=${$c.data('recid')}`;\r\n    });\r\n    $('#btn-delete').on('click', async () => {\r\n        const $checked = $table.find('tbody input.row-check:checked');\r\n        const count = $checked.length;\r\n        if (count === 0) return;\r\n\r\n        const msg = count === 1 ? '¿Está seguro de eliminar este préstamo?' : `¿Está seguro de eliminar ${count} préstamos?`;\r\n        (w as any).ALERTS?.confirm?.(msg, 'Confirmar Eliminación', async (ok: boolean) => {\r\n            if (!ok) return;\r\n            try {\r\n                const ops: Promise<void>[] = [];\r\n                $checked.each(function () {\r\n                    const id = $(this).data('recid');\r\n                    if (id) ops.push(deleteLoan(String(id)));\r\n                });\r\n                await Promise.all(ops);\r\n                (w as any).ALERTS?.ok?.('Préstamo(s) eliminado(s) correctamente', 'Éxito');\r\n                $table.DataTable().ajax.reload();\r\n            } catch (err) {\r\n                console.error('Error al eliminar:', err);\r\n                (w as any).ALERTS?.error?.('Error al eliminar préstamo(s)', 'Error');\r\n            }\r\n        }, { type: 'danger' });\r\n    });\r\n\r\n    // Exportar/Importar\r\n    $('#btn-export').on('click', exportToCSV);\r\n    $('#btn-import').on('click', () => (w as any).ALERTS?.info?.('Funcionalidad de importación próximamente', 'Información'));\r\n\r\n    // Click fila → toggle checkbox\r\n    $table.on('click', 'tbody tr', function (e: any) {\r\n        if ($(e.target).is('input.row-check') || $(e.target).closest('.icheckbox_flat-green').length) return;\r\n        const $cb = $(this).find('input.row-check');\r\n        if (!$cb.length) return;\r\n        if ($.fn.iCheck) $cb.iCheck($cb.is(':checked') ? 'uncheck' : 'check'); else $cb.prop('checked', !$cb.prop('checked'));\r\n    });\r\n\r\n    // Doble clic → editar\r\n    $table.on('dblclick', 'tbody tr', function () {\r\n        const id = $(this).find('input.row-check').data('recid');\r\n        if (id) window.location.href = `/Loan/NewEdit?recId=${id}`;\r\n    });\r\n\r\n    // Columnas\r\n    $('#btn-manage-columns').on('click', () => { gridColumnsManager?.showColumnsModal?.(); });\r\n    $('#btn-apply-columns').on('click', () => {\r\n        const cfg = gridColumnsManager.applyColumns() as ColumnConfig[];\r\n        const newCols = cfg.filter(c => c.visible).sort((a, b) => a.order - b.order).map(c => c.field);\r\n        applyColumnChanges(newCols);\r\n        ($('#modal-manage-columns') as any).modal('hide');\r\n    });\r\n\r\n    // Guardar vista\r\n    $('#btn-new-view').on('click', (e) => {\r\n        e.preventDefault();\r\n        $('#view-name').val('');\r\n        $('#view-is-default').prop('checked', false);\r\n        $('#view-is-public').prop('checked', false);\r\n        ($('#modal-save-view') as any).modal('show');\r\n    });\r\n\r\n    $('#btn-confirm-save-view').on('click', async () => {\r\n        const viewName = String($('#view-name').val() || '').trim();\r\n        const isDefault = $('#view-is-default').is(':checked');\r\n        const isPublic = $('#view-is-public').is(':checked');\r\n        if (!viewName) { (w as any).ALERTS?.warn?.('Ingrese un nombre para la vista', 'Advertencia'); return; }\r\n\r\n        const cfg = gridColumnsManager.getCurrentColumnConfig();\r\n        const ok = await gridViewsManager.saveView(viewName, cfg, isDefault, isPublic);\r\n        if (ok) {\r\n            ($('#modal-save-view') as any).modal('hide');\r\n            $('#current-view-name').text(viewName);\r\n            $('#btn-save-view-changes').hide();\r\n            updateViewsDropdown();\r\n        }\r\n    });\r\n\r\n    // Guardar Como\r\n    $('#btn-save-as-view').on('click', () => {\r\n        $('#view-name-saveas').val('');\r\n        $('#view-is-default-saveas').prop('checked', false);\r\n        $('#view-is-public-saveas').prop('checked', false);\r\n        ($('#modal-save-as-view') as any).modal('show');\r\n    });\r\n\r\n    $('#btn-confirm-save-as').on('click', async () => {\r\n        const viewName = String($('#view-name-saveas').val() || '').trim();\r\n        const isDefault = $('#view-is-default-saveas').is(':checked');\r\n        const isPublic = $('#view-is-public-saveas').is(':checked');\r\n        if (!viewName) { (w as any).ALERTS?.warn?.('Ingrese un nombre para la vista', 'Advertencia'); return; }\r\n\r\n        const cfg = gridColumnsManager.getCurrentColumnConfig();\r\n        const ok = await gridViewsManager.saveView(viewName, cfg, isDefault, isPublic);\r\n        if (ok) {\r\n            ($('#modal-save-as-view') as any).modal('hide');\r\n            $('#current-view-name').text(viewName);\r\n            $('#btn-save-view-changes').hide();\r\n            updateViewsDropdown();\r\n        }\r\n    });\r\n\r\n    // Guardar cambios de vista activa\r\n    $('#btn-save-view-changes').on('click', async () => {\r\n        if (!gridViewsManager?.hasCurrentView?.()) { (w as any).ALERTS?.warn?.('No hay vista activa para actualizar', 'Advertencia'); return; }\r\n        const cfg = gridColumnsManager.getCurrentColumnConfig();\r\n        const ok = await gridViewsManager.updateView(cfg);\r\n        if (ok) $('#btn-save-view-changes').hide();\r\n    });\r\n\r\n    // Restablecer vista por defecto\r\n    $('#btn-reset-view').on('click', () => {\r\n        (w as any).ALERTS?.confirm?.('¿Desea restablecer a la vista por defecto?', 'Confirmar', (ok: boolean) => {\r\n            if (!ok) return;\r\n            gridColumnsManager.resetToDefault(defaultColumns);\r\n            applyColumnChanges(defaultColumns);\r\n            $('#current-view-name').text('Vista por defecto');\r\n            $('#btn-save-view-changes').hide();\r\n        });\r\n    });\r\n\r\n    // Cambiar a \"Vista por defecto\" desde el dropdown\r\n    $(document).on('click', '[data-view=\"default\"]', (e) => {\r\n        e.preventDefault();\r\n        gridColumnsManager.resetToDefault(defaultColumns);\r\n        applyColumnChanges(defaultColumns);\r\n        $('#current-view-name').text('Vista por defecto');\r\n        $('#btn-save-view-changes').hide();\r\n    });\r\n\r\n    // ==== Bootstrap ====\r\n    $(async function () {\r\n        try {\r\n            // Descubrir columnas\r\n            const probeUrl = `${apiBase}/Loans?pageNumber=1&pageSize=1`;\r\n            const probe: LoanResponse | LoanRow[] = await fetchJson(probeUrl);\r\n            if (Array.isArray(probe) && probe.length) {\r\n                allColumns = getColumnsFromData(probe[0]);\r\n            } else if (!Array.isArray(probe) && probe?.Data?.length) {\r\n                allColumns = getColumnsFromData(probe.Data[0]);\r\n            } else {\r\n                allColumns = [...defaultColumns];\r\n            }\r\n\r\n            const GVM = (w as any).GridViewsManager;\r\n            const GCM = (w as any).GridColumnsManager;\r\n            if (!GVM || !GCM) {\r\n                console.warn('GridViewsManager / GridColumnsManager no disponibles. Usando vista por defecto.');\r\n                visibleColumns = [...defaultColumns];\r\n                initializeDataTable(visibleColumns);\r\n                return;\r\n            }\r\n\r\n            gridViewsManager = new GVM(apiBase, token, \"Loans\", userRefRecID, dataareaId);\r\n            const saved: ColumnConfig[] = await gridViewsManager.initialize();\r\n            if (saved?.length) {\r\n                visibleColumns = saved.filter(c => c.visible).sort((a, b) => a.order - b.order).map(c => c.field);\r\n                $('#current-view-name').text(gridViewsManager.getCurrentViewName?.() || 'Vista por defecto');\r\n            } else {\r\n                visibleColumns = [...defaultColumns];\r\n            }\r\n\r\n            gridColumnsManager = new GCM(allColumns, visibleColumns, (newCols: string[]) => applyColumnChanges(newCols));\r\n\r\n            updateViewsDropdown();\r\n            initializeDataTable(visibleColumns); // Primera carga (sin duplicados y sin desaparecer)\r\n        } catch (err) {\r\n            console.error('Error en inicialización:', err);\r\n            visibleColumns = [...defaultColumns];\r\n            initializeDataTable(visibleColumns);\r\n            showError('Error al cargar la configuración');\r\n        }\r\n    });\r\n})();\r\n"]}